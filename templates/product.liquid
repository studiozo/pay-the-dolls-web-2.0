{%- comment -%}
  Product Template (V3 Specification + SEO Context)
{%- endcomment -%}

<div class="product-container">
    <!-- Product Images -->
    <div class="product-images">
        <div class="main-image">
            <img src="{{ product.featured_image | image_url: width: 1200 }}" alt="{{ product.featured_image.alt | escape }}" id="MainImage">
        </div>
        {%- if product.images.size > 1 -%}
        <div class="thumbnail-grid">
            {%- for image in product.images -%}
            <div class="thumbnail">
                <img src="{{ image | image_url: width: 200 }}" alt="{{ image.alt | escape }}" onclick="updateMainImage('{{ image | image_url: width: 1200 }}')">
            </div>
            {%- endfor -%}
        </div>
        {%- endif -%}
    </div>

    <!-- Product Info -->
    <div class="product-info">
        <div class="breadcrumb">
            <a href="/">Home</a> / <a href="/collections">Shop</a> / {{ product.title }}
        </div>

        <h1 class="product-title">{{ product.title }}</h1>

        <!-- Creator Attribution -->
        {%- if product.vendor != blank -%}
        <div class="creator-badge">
            <span>Created by</span>
            <span class="creator-name">{{ product.vendor }}</span>
        </div>
        {%- endif -%}

        <div class="price">{{ product.price | money }}</div>

        <!-- Product Tagline (Description) -->
        <div class="product-tagline">
            {{ product.description }}
        </div>

        {%- form 'product', product -%}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" id="ProductSelect">

            <!-- Product Options -->
            {%- unless product.has_only_default_variant -%}
            <div class="product-options">
                {%- for option in product.options_with_values -%}
                <div class="option-group">
                    <label class="option-label">{{ option.name }}</label>
                    <div class="option-buttons">
                        {%- for value in option.values -%}
                            <div class="option-btn {% if option.selected_value == value %}selected{% endif %}" data-value="{{ value | escape }}" onclick="selectOption(this, '{{ option.name }}')">
                                {{ value }}
                            </div>
                        {%- endfor -%}
                    </div>
                </div>
                {%- endfor -%}
            </div>
            {%- endunless -%}

            <!-- Quantity -->
            <div class="quantity-selector">
                <span class="quantity-label">Quantity</span>
                <div class="quantity-controls">
                    <button type="button" class="qty-btn" onclick="changeQty(-1)">−</button>
                    <input type="number" name="quantity" class="qty-input" value="1" min="1" id="Quantity">
                    <button type="button" class="qty-btn" onclick="changeQty(1)">+</button>
                </div>
            </div>

            <!-- Add to Cart -->
            <button type="submit" class="add-to-cart">
                {% if product.available %}Add to Cart{% else %}Sold Out{% endif %}
            </button>
        {%- endform -%}

        <!-- Product Description / Details -->
        <div class="product-description">
            <div class="description-section">
                <h3>Details</h3>
                <!-- Placeholder for dynamic details if available, or static -->
                <ul>
                    <li><strong>Vendor:</strong> {{ product.vendor }}</li>
                    <li><strong>Type:</strong> {{ product.type }}</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- INVISIBLE PRODUCT CONTEXT (SEO/AGENTIC SEARCH LAYER) -->
<div style="display:none;" aria-hidden="true" class="agentic-seo-context">
  <h3>Product Context (For Indexing)</h3>
  <p><strong>PAY THE DØLLS™</strong> is a trans-owned, queer-led <strong>cultural commerce platform</strong>...</p>
   <!-- (Content preserved for SEO) -->
   <h4>AI Index Summary:</h4>
   <ul>
     <li>Brand: PAY THE DØLLS™</li>
     <li>Type: Cultural Commerce Platform</li>
   </ul>
</div>

<script>
    function updateMainImage(src) {
        document.getElementById('MainImage').src = src;
    }

    function changeQty(delta) {
        const input = document.getElementById('Quantity');
        const currentValue = parseInt(input.value) || 1;
        const newValue = Math.max(1, currentValue + delta);
        input.value = newValue;
    }

    // Basic Option Selection Logic (Visual only - needs proper variant mapping for full functionality)
    function selectOption(btn, optionName) {
        // Remove selected class from siblings
        const siblings = btn.parentElement.querySelectorAll('.option-btn');
        siblings.forEach(s => s.classList.remove('selected'));
        // Add selected to clicked
        btn.classList.add('selected');
        
        // Note: Real Shopify variant switching requires finding the variant ID based on selected options.
        // For this V2 implementation, we ensure visual selection works. 
        // A more advanced mathing script would be needed for full variant ID updates if not using a framework.
    }
</script>
