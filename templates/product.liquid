{%- comment -%}
  Product Template (V3 Specification + SEO Context) - Synced with Drafts V2
  Based on ProductPage.tsx
{%- endcomment -%}

<div class="product-container max-w-[1400px] mx-auto my-20 px-6 md:px-12 grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-[100px]">

    <!-- Left Column: Images (ProductGallery) -->
    <div class="w-full">
        <div class="product-gallery">
            <div class="main-image mb-4">
                <img 
                    src="{{ product.featured_image | image_url: width: 1200 }}" 
                    alt="{{ product.featured_image.alt | escape }}" 
                    id="MainImage"
                    class="w-full h-auto object-cover border border-brand-border"
                >
            </div>
            {%- if product.images.size > 1 -%}
            <div class="thumbnail-grid grid grid-cols-4 gap-4">
                {%- for image in product.images -%}
                <button 
                    type="button"
                    class="thumbnail w-full aspect-square border border-transparent hover:border-brand-neon transition-all p-1 cursor-pointer {% if image.id == product.featured_image.id %}border-brand-neon{% endif %}"
                    onclick="updateMainImage('{{ image | image_url: width: 1200 }}', this)"
                    aria-label="View image {{ forloop.index }}"
                >
                    <img src="{{ image | image_url: width: 200 }}" alt="{{ image.alt | escape }}" class="w-full h-full object-cover">
                </button>
                {%- endfor -%}
            </div>
            {%- endif -%}
        </div>
    </div>

    <!-- Right Column: Product Info -->
    <div class="product-info pt-5">
        <!-- Breadcrumb -->
        <div class="breadcrumb text-xs text-[#666] mb-6 tracking-[0.5px]">
            <a href="/" class="text-brand-dark no-underline hover:text-brand-neon">Home</a> / <a href="/collections" class="text-brand-dark no-underline hover:text-brand-neon">Shop</a> / {{ product.title }}
        </div>

        <h1 class="product-title text-[32px] md:text-[42px] font-semibold text-black mb-5 tracking-[-0.02em] leading-[1.1]">
            {{ product.title }}
        </h1>

        <!-- Creator Attribution -->
        {%- if product.vendor != blank -%}
        <div class="creator-badge inline-flex items-center gap-2 px-4 py-2.5 mb-8 rounded bg-brand-light border border-brand-border text-sm font-medium cursor-pointer hover:bg-[rgba(0,255,136,0.12)] hover:border-[rgba(0,255,136,0.3)] transition-all">
            <span class="text-black">Created by</span>
            <span class="creator-name text-brand-dark font-semibold">{{ product.vendor }}</span>
        </div>
        {%- endif -%}

        <!-- Price -->
        <div class="price text-[32px] font-semibold text-black mb-8">
            {{ product.price | money }}
        </div>

        <!-- Product Tagline (Description) -->
        <div class="product-tagline mb-10 p-6 bg-brand-light border-l-[3px] border-brand-neon rounded text-[15px] leading-[1.8] text-[#333]">
            {{ product.description }}
        </div>

        <!-- Product Form -->
        {%- form 'product', product -%}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" id="ProductSelect">

            <!-- Product Options -->
            {%- unless product.has_only_default_variant -%}
            <div class="product-options mb-8">
                {%- for option in product.options_with_values -%}
                <div class="option-group mb-6">
                    <label class="option-label block text-sm font-semibold text-brand-dark mb-3">{{ option.name }}</label>
                    <div class="option-buttons flex flex-wrap gap-3">
                        {%- for value in option.values -%}
                            <button 
                                type="button"
                                class="option-btn px-6 py-3 border border-brand-border bg-white text-sm font-medium transition-all hover:border-brand-neon min-w-[3rem] {% if option.selected_value == value %}bg-brand-dark text-white border-brand-dark{% else %}text-black{% endif %}" 
                                data-value="{{ value | escape }}" 
                                onclick="selectOption(this, '{{ option.name }}')"
                            >
                                {{ value }}
                            </button>
                        {%- endfor -%}
                    </div>
                </div>
                {%- endfor -%}
            </div>
            {%- endunless -%}

            <!-- Actions Row -->
            <div class="flex items-center gap-4 mb-10">
                <!-- Quantity -->
                <div class="quantity-selector flex items-center border border-brand-border rounded">
                   <button type="button" class="w-10 h-12 flex items-center justify-center text-lg hover:bg-gray-50" onclick="changeQty(-1)">−</button>
                   <input type="number" name="quantity" class="w-12 h-12 text-center border-x border-brand-border text-base focus:outline-none" value="1" min="1" id="Quantity">
                   <button type="button" class="w-10 h-12 flex items-center justify-center text-lg hover:bg-gray-50" onclick="changeQty(1)">+</button>
                </div>

                <!-- Add to Cart -->
                <button type="submit" class="add-to-cart flex-1 bg-brand-neon text-black h-12 px-8 font-bold uppercase tracking-widest hover:bg-[#00dd77] hover:-translate-y-0.5 transition-all shadow-lg shadow-[rgba(0,255,136,0.2)]">
                    {% if product.available %}Add to Cart{% else %}Sold Out{% endif %}
                </button>
            </div>
        {%- endform -%}

        <!-- Product Details Section -->
        <div class="product-details border-t border-brand-border pt-10">

            <div class="description-section mb-8">
                <h3 class="text-base font-semibold text-brand-dark mb-4 uppercase tracking-[1px]">Details</h3>
                <ul class="list-none p-0 text-[15px] leading-[1.8] text-[#555]">
                    <li class="py-1"><strong>Vendor:</strong> {{ product.vendor }}</li>
                    <li class="py-1"><strong>Type:</strong> {{ product.type }}</li>
                    <!-- Mock data to match design until metafields are ready -->
                    <li class="py-1"><strong>Fabric:</strong> 100% Polyester</li>
                    <li class="py-1"><strong>Fit:</strong> Loose, relaxed</li>
                </ul>
            </div>

            <div class="description-section mb-8">
                <h3 class="text-base font-semibold text-brand-dark mb-4 uppercase tracking-[1px]">Care Instructions</h3>
                <ul class="list-none p-0 text-[15px] leading-[1.8] text-[#555]">
                    <li class="py-1">Machine wash at 30°C (gentle cycle)</li>
                    <li class="py-1">Do not bleach</li>
                    <li class="py-1">Tumble dry low</li>
                    <li class="py-1">Iron at low temperature</li>
                </ul>
            </div>

            <div class="description-section mb-8">
                <h3 class="text-base font-semibold text-brand-dark mb-4 uppercase tracking-[1px]">Size Chart</h3>
                <div class="size-chart overflow-x-auto mt-6">
                    <table class="w-full border-collapse text-[13px]">
                        <thead>
                            <tr>
                                <th class="p-3 text-left border border-brand-border bg-brand-light font-semibold text-brand-dark">Size</th>
                                <th class="p-3 text-left border border-brand-border bg-brand-light font-semibold text-brand-dark">Length (in/cm)</th>
                                <th class="p-3 text-left border border-brand-border bg-brand-light font-semibold text-brand-dark">Waist (in/cm)</th>
                                <th class="p-3 text-left border border-brand-border bg-brand-light font-semibold text-brand-dark">Hip (in/cm)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Static mock data matching React component for visual parity -->
                            <tr><td class="p-3 border border-brand-border text-[#555] font-bold">S</td><td class="p-3 border border-brand-border text-[#555]">18.1 / 46</td><td class="p-3 border border-brand-border text-[#555]">11.8 / 30</td><td class="p-3 border border-brand-border text-[#555]">20.5 / 52</td></tr>
                            <tr><td class="p-3 border border-brand-border text-[#555] font-bold">M</td><td class="p-3 border border-brand-border text-[#555]">18.9 / 48</td><td class="p-3 border border-brand-border text-[#555]">12.2 / 31</td><td class="p-3 border border-brand-border text-[#555]">21.3 / 54</td></tr>
                            <tr><td class="p-3 border border-brand-border text-[#555] font-bold">L</td><td class="p-3 border border-brand-border text-[#555]">19.7 / 50</td><td class="p-3 border border-brand-border text-[#555]">12.6 / 32</td><td class="p-3 border border-brand-border text-[#555]">22.0 / 56</td></tr>
                            <tr><td class="p-3 border border-brand-border text-[#555] font-bold">XL</td><td class="p-3 border border-brand-border text-[#555]">20.5 / 52</td><td class="p-3 border border-brand-border text-[#555]">13.0 / 33</td><td class="p-3 border border-brand-border text-[#555]">22.8 / 58</td></tr>
                            <tr><td class="p-3 border border-brand-border text-[#555] font-bold">2XL</td><td class="p-3 border border-brand-border text-[#555]">21.3 / 54</td><td class="p-3 border border-brand-border text-[#555]">13.4 / 34</td><td class="p-3 border border-brand-border text-[#555]">23.6 / 60</td></tr>
                            <tr><td class="p-3 border border-brand-border text-[#555] font-bold">3XL</td><td class="p-3 border border-brand-border text-[#555]">22.0 / 56</td><td class="p-3 border border-brand-border text-[#555]">13.8 / 35</td><td class="p-3 border border-brand-border text-[#555]">24.4 / 62</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- INVISIBLE PRODUCT CONTEXT (SEO/AGENTIC SEARCH LAYER) -->
<div style="display:none;" aria-hidden="true" class="agentic-seo-context">
  <h3>Product Context (For Indexing)</h3>
  <p><strong>PAY THE DØLLS™</strong> is a trans-owned, queer-led <strong>cultural commerce platform</strong>...</p>
   <!-- (Content preserved for SEO) -->
   <h4>AI Index Summary:</h4>
   <ul>
     <li>Brand: PAY THE DØLLS™</li>
     <li>Type: Cultural Commerce Platform</li>
   </ul>
</div>

<script>
    function updateMainImage(src, thumbnail) {
        document.getElementById('MainImage').src = src;
        
        // Update active class
        if (thumbnail) {
            document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('border-brand-neon'));
            thumbnail.classList.add('border-brand-neon');
        }
    }

    function changeQty(delta) {
        const input = document.getElementById('Quantity');
        const currentValue = parseInt(input.value) || 1;
        const newValue = Math.max(1, currentValue + delta);
        input.value = newValue;
    }

    // Basic Visual Selection for Options
    function selectOption(btn, optionName) {
        // Remove selected styling from siblings
        const siblings = btn.parentElement.querySelectorAll('.option-btn');
        siblings.forEach(s => {
            s.classList.remove('bg-brand-dark', 'text-white', 'border-brand-dark');
            s.classList.add('text-black');
        });
        
        // Add selected styling to clicked
        btn.classList.remove('text-black');
        btn.classList.add('bg-brand-dark', 'text-white', 'border-brand-dark');
        
        // Note: Actual variant ID update logic would go here
    }
</script>
